# 实习收获记录

## 业务方面

### 广告相关术语

#### 一、结算方式（COST TYPE，微信广告主要是CPM和CPC）

1. CPM（Cost Per Mille）：按展示收费，即每千次展示需要付多少钱
   eCPM（expected Cost Per Mille）
   eCPM = u x v，u表示点击率，v表示点击价值，即单次点击为广告产品带来的收益
   千次展示期望收入,直白说是流量的价值，对媒体方来说，衡量自己的流量质量的关键指标，即每个曝光平均卖了多少钱；eCPM高，则说明填充率高==>流量竞争激烈==>受到客户的追捧==>用户价值高
   eCPM三个决定因素：CTR/CVR/出价
2. CPC（Cost Per Click）：按点击收费
3. CPA（Cost Per Action）：按行动收费，A可以是注册、下载、下单、购买等等，监测方式除了要部署到媒体上，还要部署到广告主的目标页面上，来看最终的Action效果
4. CPS（Cost Per Sale）：根据他为商家带来的实际销售向广告主收取费用，一般按照一个百分比或固定的佣金比例收取（销售额的10%– 50% 不等）。 商家不会轻易的向联盟会员付费，只有在联盟会员介绍的客人在商家网站上产生了实际购买行为后（大多数是在线支付）才给联盟会员付费。
5. CPT（Cost Per Time）：针对大品牌广告主，将某个广告位以独占的方式交给某个广告主，并按独占的时间段收取费用的方式。

#### 二、效果衡量指标

1. CTR（Click Through Rate），点击通过率，即点击数除以展示数量
2. CVR（Conversion Rate），转化率，点击广告到成为一个有效激活或者注册甚至付费用户的转化率。
3. ROI（Return on Investment），投资回报率，即“利润/成本”，对广告主来说ROI越大越好，是广告主衡量投放价值的指标，广告系统需要帮助广告主提升ROI，方法入提供新的广告位，提供新的广告交互形式来吸引用户点击，优化引擎算法让推荐能够更加精准等等，当广告主的ROI提升了，他愿意花在广告投放的预算就会增加，最终反映在广告系统的eCPM指标上。
4. ARPU（Average Revenue Per User），每用户平均收入
5. GMV（Gross Merchandise Volume），总成交额，是站在广告主角度的一个衡量指标，即广告主通过广告渠道带来了多少成交额

## 技术方面

### 加载优化

#### CDN 优化

通过 link 标签的 `rel = "dns-prefetch"` 属性，对于之后会访问的域名（广告域名、CDN 域名）进行预解析，减少 DNS 解析的耗时

####  文件加载优化

1. 缓存 html 文件
   1. 更新时，通过版本会更改 url 的路径，就会下载最新的基础库文件
2. 通过 service worker 进行请求拦截，并操控对于资源文件的缓存

#### 秒开能力

以支付后广告为例，应用场景是微信支付之后，点击完成，会跳转一个广告界面

在支付后，会提前拉取广告数据以及前端的静态资源，缓存在客户端中，在点击完成后，使用客户端缓存的资源进行展示

### 上报方面

上报的行为中，有成功的行为的上报也有错误上报，为了减少上报数据的资源占用

1. 对于错误上报，依然采用全量上报，对于成功的行为的上报，采用抽样（随机数）
2. 前端上报时，可以设置 delay，以等待一定时间进行批量上报，一个是减少资源的并发量，一个是防止上报操作阻塞主线程（因为上报需要进行数据获取以及数据整理，有一定耗时）

### 广告实现

#### 曝光检测

通过轮询的方式检测 layoutBox 是否存在

在展示广告时，调用 `Layout.layout()` 才会进行布局渲染
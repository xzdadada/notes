# 视频分片播放踩坑

在业务中需要一个需求，需要优化视频资源的带宽消耗，一个优化角度是采用视频分片的方法，边下边播，这也是目前主流视频网站采用的策略，有几点好处

1. 大资源分片，可以利用 HTTP2 的并行请求来提高下载速度，实现视频的快速播放
2. 对于用户不会观看到的片段不进行加载，以节约带宽等资源

## Media Source Extends

### 实现



#### 几个关键点

1. sourceopen 触发的时机：MSE 实例已经附加到媒体元素，准备接受或正在接收数据时触发，也就是将 MSE 的 url 赋值给 video 元素，并触发下载时

### 问题

在开发中，发现使用官网的例子会触发video 以及 sourceBuffer 的 error，查阅网络资料，原因是普通的 MP4 格式的视频是无法使用 MSE 的，需要通过一些工具（ bento4 等）将其转换为 FMP4 格式